<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Quick Survey</title>
<style>
* { box-sizing: border-box; margin: 0; padding: 0; }
body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; background: #f5f5f7; color: #1d1d1f; padding: 20px; max-width: 600px; margin: 0 auto; }
h1 { font-size: 24px; margin-bottom: 8px; }
.subtitle { color: #86868b; margin-bottom: 24px; font-size: 15px; }
.question { background: #fff; border-radius: 12px; padding: 20px; margin-bottom: 16px; box-shadow: 0 1px 3px rgba(0,0,0,0.08); }
.question h3 { font-size: 16px; margin-bottom: 12px; font-weight: 600; }
.question .note { font-size: 13px; color: #86868b; margin-bottom: 8px; }
label { display: block; padding: 10px 12px; margin: 4px 0; border-radius: 8px; cursor: pointer; font-size: 15px; transition: background 0.15s; }
label:hover { background: #f0f0f5; }
input[type="radio"], input[type="checkbox"] { margin-right: 10px; accent-color: #0071e3; }
.submit-btn { display: block; width: 100%; padding: 16px; background: #0071e3; color: #fff; border: none; border-radius: 12px; font-size: 17px; font-weight: 600; cursor: pointer; margin-top: 24px; }
.submit-btn:hover { background: #0077ED; }
.submit-btn:disabled { background: #86868b; cursor: not-allowed; }
.result { display: none; background: #fff; border-radius: 12px; padding: 24px; margin-top: 24px; text-align: center; box-shadow: 0 1px 3px rgba(0,0,0,0.08); }
.result h2 { margin-bottom: 12px; }
.result .code { background: #f5f5f7; padding: 16px; border-radius: 8px; font-family: monospace; font-size: 14px; word-break: break-all; margin: 16px 0; user-select: all; }
.result .copy-btn { padding: 12px 24px; background: #34c759; color: #fff; border: none; border-radius: 8px; font-size: 15px; cursor: pointer; }
.progress { font-size: 13px; color: #86868b; text-align: right; margin-bottom: 8px; }
</style>
</head>
<body>
<h1>Cognitive Profile Survey</h1>
<p class="subtitle">15 quick multiple-choice questions about how you see Mike. Takes ~3 minutes. Your answers are private.</p>

<div id="progress" class="progress"></div>
<form id="survey">
</form>

<button class="submit-btn" id="submitBtn" onclick="submitSurvey()" disabled>Submit</button>

<div class="result" id="result">
<h2>âœ… Done!</h2>
<p>Send this code back to Mike:</p>
<div class="code" id="codeOutput"></div>
<button class="copy-btn" onclick="copyCode()">Copy Code</button>
<p style="margin-top:12px; color:#86868b; font-size:13px;">Just paste it in your text conversation.</p>
</div>

<script>
const questions = [
  {q: "Under pressure, Mike tends to:", opts: ["Talk more, take on more", "Go quiet and disappear into a project", "Get short or irritable", "Seem the same but small things change", "Cycle between several"]},
  {q: "When overwhelmed, his first sign is:", opts: ["Slower message responses", "Forgets small things", "Hyperfocuses on one thing", "Sleep/eating changes", "Starts planning something new", "Can't tell when overwhelmed"]},
  {q: "When he needs help:", opts: ["Asks directly", "Hints but doesn't ask", "Handles it alone", "Doesn't ask, things fall through", "Only asks one specific person"]},
  {q: "His top 2 ways to decompress:", opts: ["TV/media", "Tinker/build", "Exercise", "Read/research", "Social time", "Sleep", "Doesn't decompress"], multi: true, max: 2},
  {q: "His emotional vulnerability level:", opts: ["Very easy, shares openly", "Shares after processing alone first", "Rarely vulnerable, have to pull it out", "Expresses through actions not words", "Depends on topic"]},
  {q: "Being around Mike feels like:", opts: ["Co-strategist", "Protector", "Whirlwind", "Quiet anchor", "Mix depending on context"]},
  {q: "You have least access to his:", opts: ["Work stress", "Fears about future", "What he's feeling in the moment", "Creative/project world", "Political/philosophical thinking", "Good access to all"]},
  {q: "Who worries more about money:", opts: ["He worries more", "I worry more", "Same amount, different things", "Neither worries much", "Shifts depending"]},
  {q: "His relationship with money is:", opts: ["Careful planner", "Strategic spender", "Anxious even when fine", "Generous with others, tight with self", "Doesn't think about it", "Depends on season"]},
  {q: "His worldview has:", opts: ["Stayed consistent", "Shifted noticeably recently", "Gradually evolved", "One or two big turning points", "Not sure, doesn't talk about it"]},
  {q: "When he changes his mind, you find out by:", opts: ["He tells directly", "Notice behavior shifting", "He brings up a new idea/project", "Someone else mentions it", "He doesn't change his mind often"]},
  {q: "His biggest surprise over time:", opts: ["More emotional/sensitive than appeared", "More ambitious than expected", "Unexpected interests/skills", "Values shifted unexpectedly", "No surprises, WYSIWYG"]},
  {q: "His unrecognized strength:", opts: ["Cares through actions not words", "Sees patterns others miss", "Calm in chaos", "More creative than realizes", "Patient with struggling people", "Makes others feel capable"]},
  {q: "One thing he should change:", opts: ["Takes on too much", "Could be more emotionally present", "Moves too fast, doesn't bring people along", "Could relax more", "Could talk about feelings more", "Nothing major"]},
  {q: "What you want him to know:", opts: ["I'm proud of you", "Don't have to carry everything alone", "I see how hard you work", "Wish we had more unstructured time", "You're enough even when not building", "I trust your judgment more than you think"]}
];

const form = document.getElementById('survey');
questions.forEach((q, i) => {
  const div = document.createElement('div');
  div.className = 'question';
  let html = `<h3>${i+1}. ${q.q}</h3>`;
  if (q.multi) html += `<div class="note">Pick up to ${q.max}</div>`;
  q.opts.forEach((opt, j) => {
    const type = q.multi ? 'checkbox' : 'radio';
    const name = `q${i}`;
    html += `<label><input type="${type}" name="${name}" value="${j}" onchange="checkProgress(${q.multi ? 'true' : 'false'}, '${name}', ${q.max || 0})">${opt}</label>`;
  });
  div.innerHTML = html;
  form.appendChild(div);
});

function checkProgress(isMulti, name, max) {
  if (isMulti && max) {
    const checked = document.querySelectorAll(`input[name="${name}"]:checked`);
    if (checked.length > max) {
      event.target.checked = false;
      return;
    }
  }
  let answered = 0;
  questions.forEach((q, i) => {
    const checked = document.querySelectorAll(`input[name="q${i}"]:checked`);
    if (checked.length > 0) answered++;
  });
  document.getElementById('progress').textContent = `${answered}/${questions.length} answered`;
  document.getElementById('submitBtn').disabled = (answered < questions.length);
}

function submitSurvey() {
  const answers = [];
  questions.forEach((q, i) => {
    const checked = document.querySelectorAll(`input[name="q${i}"]:checked`);
    if (q.multi) {
      answers.push(Array.from(checked).map(c => c.value).join('+'));
    } else {
      answers.push(checked[0]?.value || '0');
    }
  });
  const payload = 'epsilon|' + answers.join('|');
  const code = btoa(payload).replace(/=/g, '');
  document.getElementById('codeOutput').textContent = code;
  document.getElementById('result').style.display = 'block';
  document.getElementById('submitBtn').style.display = 'none';
  document.getElementById('result').scrollIntoView({behavior: 'smooth'});
}

function copyCode() {
  const code = document.getElementById('codeOutput').textContent;
  navigator.clipboard.writeText(code).then(() => {
    document.querySelector('.copy-btn').textContent = 'Copied!';
    setTimeout(() => document.querySelector('.copy-btn').textContent = 'Copy Code', 2000);
  });
}
</script>
</body>
</html>
